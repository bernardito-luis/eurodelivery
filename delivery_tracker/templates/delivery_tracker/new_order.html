{% extends 'delivery_tracker/base.html' %}
{% load staticfiles %}

{% block content %}
    <div class="container">
        <div class="row top-offset-20">
            <div class="col-md-offset-8 col-md-3">
                <b>Welcome{% if user.first_name %}, {{ user.first_name }}{% endif %}!</b>
            </div>
            <div class="col-md-1">
                <b><a href="{% url 'logout' %}">Logout</a></b>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 top-offset-20">
                <div class="header_stripe">
                    <a href="{% url 'cabinet' %}">
                        <span class="glyphicon glyphicon-heart" aria-hidden="true" style="color: white"></span> Главная
                    </a> -
                    <a href="{% url 'orders_and_bills' %}">Заказы и счета</a> -
                    <a href="{% url 'new_order' %}">Создать новый заказ</a>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-offset-4 col-sm-offset-4 col-md-4 col-sm-4">
                {% for msg in messages %}
                    <b>{{ msg }}</b><br/>
                {% endfor %}

            </div>
        </div>
        <div class="row top-offset-20">
            <div class="col-md-12">
                <form id="id_order_form" action="{% url 'new_order' %}" method="post" class="form-horizontal">
                    {% csrf_token %}

                    {{ form.shipping_cost.errors }}
                    <div class="form-group">
                        <label for="id_shipping_cost" class="control-label col-sm-2">Стоимость доставки</label>
                        <div class="col-sm-5">
                            <input id="id_shipping_cost" type="text" name="shipping_cost" value="{{ form.shipping_cost.value }}" class="form-control" />
                        </div>
                    </div>
                    {{ form.coupon.errors }}
                    <div class="form-group">
                        <label for="id_coupon" class="control-label col-sm-2">Код скидки на наши услуги</label>
                        <div class="col-sm-5">
                            <input id="id_coupon" type="text" name="coupon" value="" class="form-control" />
                        </div>
                    </div>
                    {{ form.discount.errors }}
                    <div class="form-group">
                        <label for="id_discount" class="control-label col-sm-2">Размер скидки на наши услуги</label>
                        <div class="col-sm-5">
                            <input id="id_discount" type="text" name="discount" value="{{ form.discount.value }}" class="form-control" />
                        </div>
                    </div>
                    {{ form.user_comment.errors }}
                    <div class="form-group">
                        <label for="id_user_comment" class="control-label col-sm-2">Комментарий</label>
                        <div class="col-sm-5">
                            <input id="id_user_comment" type="text" name="user_comment" value="{{ form.user_comment.value }}" class="form-control" />
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="id_current_fee" class="control-label col-sm-2">Текущий тариф</label>
                        <div class="col-sm-5">
                            <input id="id_current_fee" type="text" name="current_fee" value="{{ current_fee }}" readonly="1" class="form-control" />
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-1">Магазин</div>
                        <div class="col-md-1">Ссылка на товар*</div>
                        <div class="col-md-1">Артикул</div>
                        <div class="col-md-1">Название товара</div>
                        <div class="col-md-1">Цвет*</div>
                        <div class="col-md-1">Размер*</div>
                        <div class="col-md-1">Количество*</div>
                        <div class="col-md-1">Цена*</div>
                        <div class="col-md-1">Код скидки</div>
                        <div class="col-md-1">Сумма скидки*</div>
                        <div class="col-md-1">Сумма*</div>
                        <div class="col-md-1">Примечание</div>
                    </div>
                    <div id="id_product_list">
                    <div class="row">
                        <div class="col-sm-1">
                            <input id="id_shop_link_1" type="text" name="shop_link_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_product_link_1" type="text" name="product_link_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_vendor_code_1" type="text" name="vendor_code_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_name_1" type="text" name="name_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_color_1" type="text" name="color_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_size_1" type="text" name="size_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_quantity_1" type="text" name="quantity_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_price_1" type="text" name="price_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_discount_code_1" type="text" name="discount_code_1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_discount_in_shop_1" type="text" name="discount_in_shop_1" value="0" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_sum_1" type="text" name="sum_1" readonly="1" class="form-control" />
                        </div>
                        <div class="col-sm-1">
                            <input id="id_note_1" type="text" name="note_1" class="form-control" />
                        </div>
                    </div>
                    </div>
                    <div class="row top-offset-20 ">
                        <div class="col-md-offset-9 col-md-2">
                            <button type="button" id="id_add_product" class="btn btn-default">+ Добавить</button>
                        </div>
                    </div>

                    <div class="row form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <button type="submit" name="profile_changes" class="btn btn-default">Заказать</button>
                        </div>
                    </div>
                </form>
            </div>

        </div>
    </div>

{% endblock %}

{% block script %}
<script>
    var current_prod_qty = 1;
    $("#id_add_product").click(function () {
        current_prod_qty++;
        console.log(current_prod_qty);
        var new_product = `
            <div class="row top-offset-5">
                <div class="col-sm-1">
                    <input id="id_shop_link_(product_num)" type="text" name="shop_link_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_product_link_(product_num)" type="text" name="product_link_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_vendor_code_(product_num)" type="text" name="vendor_code_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_name_(product_num)" type="text" name="name_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_color_(product_num)" type="text" name="color_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_size_(product_num)" type="text" name="size_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_quantity_(product_num)" type="text" name="quantity_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_price_(product_num)" type="text" name="price_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_discount_code_(product_num)" type="text" name="discount_code_(product_num)" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_discount_in_shop_(product_num)" type="text" name="discount_in_shop_(product_num)" value="0" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_sum_(product_num)" type="text" name="sum_(product_num)" readonly="1" class="form-control" />
                </div>
                <div class="col-sm-1">
                    <input id="id_note_(product_num)" type="text" name="note_(product_num)" class="form-control" />
                </div>
            </div>
        `;
        new_product = new_product.replace(/\(product_num\)/g, current_prod_qty);
        var foo = 'aaaa___aa';
        foo = foo.replace(/_/g, 'b');
        console.log(foo);
        $("#id_product_list").append(new_product);
    });

</script>
{% endblock %}
